<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Python单元测试 - Suncle&#39;s Blog</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Suncle" /><meta name="description" content="单元测试 什么是单元测试, 维基百科上是这么定义的： unit testing is a method by which individual units of source code, sets of one or more computer program modules together with associated control data, usage procedures, and operating procedures, are tested to determine if they are fit for use.[1] Intuitively, one can view a unit as the smallest testable part of an application. 简而言之，就是验证系统中最小可测试单元的功能是否正确的自动化测试。因此，单元测试的目地就是“对被测试对象的职责进行验证”, 在写单元测试之前，先识别出被测试对象的职责，就知道该怎么写这个单元测试了。
根据被测试对象，单元测试可以分为两大类：
 对不依赖于外部资源的组件的单元测试：使用unittest基本功能即可 对依赖于外部资源的组件的单元测试：需要使用mock " /><meta name="keywords" content="计算机, 后端, Python, golang" />






<meta name="generator" content="Hugo 0.74.3 with theme even" />


<link rel="canonical" href="https://suncle.me/2017/11/14/Python%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<link href="/sass/main.min.651e6917abb0239242daa570c2bec9867267bbcd83646da5a850afe573347b44.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Python单元测试" />
<meta property="og:description" content="单元测试
什么是单元测试, 维基百科上是这么定义的： unit testing is a method by which individual units of source code, sets of one or more computer program modules together with associated control data, usage procedures, and operating procedures, are tested to determine if they are fit for use.[1] Intuitively, one can view a unit as the smallest testable part of an application. 简而言之，就是验证系统中最小可测试单元的功能是否正确的自动化测试。因此，单元测试的目地就是“对被测试对象的职责进行验证”, 在写单元测试之前，先识别出被测试对象的职责，就知道该怎么写这个单元测试了。
根据被测试对象，单元测试可以分为两大类：

对不依赖于外部资源的组件的单元测试：使用unittest基本功能即可
对依赖于外部资源的组件的单元测试：需要使用mock
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://suncle.me/2017/11/14/Python%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" />
<meta property="article:published_time" content="2017-11-14T20:01:27+00:00" />
<meta property="article:modified_time" content="2017-11-14T20:01:27+00:00" />
<meta itemprop="name" content="Python单元测试">
<meta itemprop="description" content="单元测试
什么是单元测试, 维基百科上是这么定义的： unit testing is a method by which individual units of source code, sets of one or more computer program modules together with associated control data, usage procedures, and operating procedures, are tested to determine if they are fit for use.[1] Intuitively, one can view a unit as the smallest testable part of an application. 简而言之，就是验证系统中最小可测试单元的功能是否正确的自动化测试。因此，单元测试的目地就是“对被测试对象的职责进行验证”, 在写单元测试之前，先识别出被测试对象的职责，就知道该怎么写这个单元测试了。
根据被测试对象，单元测试可以分为两大类：

对不依赖于外部资源的组件的单元测试：使用unittest基本功能即可
对依赖于外部资源的组件的单元测试：需要使用mock
">
<meta itemprop="datePublished" content="2017-11-14T20:01:27+00:00" />
<meta itemprop="dateModified" content="2017-11-14T20:01:27+00:00" />
<meta itemprop="wordCount" content="1377">



<meta itemprop="keywords" content="单元测试,测试," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Python单元测试"/>
<meta name="twitter:description" content="单元测试
什么是单元测试, 维基百科上是这么定义的： unit testing is a method by which individual units of source code, sets of one or more computer program modules together with associated control data, usage procedures, and operating procedures, are tested to determine if they are fit for use.[1] Intuitively, one can view a unit as the smallest testable part of an application. 简而言之，就是验证系统中最小可测试单元的功能是否正确的自动化测试。因此，单元测试的目地就是“对被测试对象的职责进行验证”, 在写单元测试之前，先识别出被测试对象的职责，就知道该怎么写这个单元测试了。
根据被测试对象，单元测试可以分为两大类：

对不依赖于外部资源的组件的单元测试：使用unittest基本功能即可
对依赖于外部资源的组件的单元测试：需要使用mock
"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Suncle&#39;s Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">首页</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">分类</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Suncle&#39;s Blog</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">首页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">分类</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Python单元测试</h1>

      <div class="post-meta">
        <span class="post-time"> 2017-11-14 </span>
        <div class="post-category">
            <a href="/categories/Python/"> Python </a>
            </div>
          <span class="more-meta"> 约 1377 字 </span>
          <span class="more-meta"> 预计阅读 3 分钟 </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次阅读 </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#单元测试">单元测试</a></li>
    <li><a href="#unittest使用">unittest使用</a></li>
    <li><a href="#mock">mock</a></li>
    <li><a href="#对单元测试的看法">对单元测试的看法</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h1 id="单元测试">单元测试</h1>
<p>什么是单元测试, 维基百科上是这么定义的： unit testing is a method by which individual units of source code, sets of one or more computer program modules together with associated control data, usage procedures, and operating procedures, are tested to determine if they are fit for use.[1] Intuitively, one can view a unit as the smallest testable part of an application. 简而言之，就是验证系统中最小可测试单元的功能是否正确的自动化测试。因此，单元测试的目地就是“对被测试对象的职责进行验证”, 在写单元测试之前，先识别出被测试对象的职责，就知道该怎么写这个单元测试了。</p>
<p>根据被测试对象，单元测试可以分为两大类：</p>
<ul>
<li>对不依赖于外部资源的组件的单元测试：使用unittest基本功能即可</li>
<li>对依赖于外部资源的组件的单元测试：需要使用mock</li>
</ul>
<h1 id="unittest使用">unittest使用</h1>
<p>python单元测试库unittest的基本使用参见<a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/00143191629979802b566644aa84656b50cd484ec4a7838000">廖雪峰Python单元测试</a></p>
<p>具体使用参考以下资料</p>
<ol>
<li><a href="https://pm.readthedocs.io/unittest/python.html">Python中的单元测试</a></li>
<li><a href="http://ningning.today/2016/11/22/python/flask-unittest/">ningning.today-flask项目单元测试实践</a></li>
<li><a href="https://docs.python.org/2/library/unittest.html">Python unittest官方文档</a></li>
<li><a href="https://wiki.jikexueyuan.com/project/explore-python/Testing/README.html">极客学院-单元测试</a></li>
<li><a href="http://nicholas.ren/2012/10/21/my-understanding-on-unit-testing.html">nicholas-怎样写单元测试</a></li>
</ol>
<h1 id="mock">mock</h1>
<p>为什么要用mock？</p>
<p><img src="https://flowsnow.oss-cn-shanghai.aliyuncs.com/history/image/blog/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95mock%E5%A4%A7%E7%89%9B%E5%9B%9E%E5%A4%8D.png" alt=""></p>
<p>看了很多篇mock的讲解，写的最好的一篇是[<a href="https://www.toptal.com/python/an-introduction-to-mocking-in-python">Naftuli Kay-An Introduction to Mocking in Python</a>，以删除文件为例组成深入讲解mock的使用。其他资料可以参见：</p>
<ol>
<li><a href="http://andrewliu.in/2015/12/12/Python%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E5%92%8CMock%E6%B5%8B%E8%AF%95/">Python单元测试和Mock测试</a></li>
<li><a href="http://www.voidspace.org.uk/python/mock/helpers.html#autospeccing">mock-autospec</a></li>
</ol>
<p>仿照这篇文章改写qk_log日志模块，qk_log.py代码如下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">logging.handlers</span>

<span class="n">_console_logger</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">_warn_logger</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">_error_logger</span> <span class="o">=</span> <span class="bp">None</span>

<span class="n">CONSOLE_FILENAME</span> <span class="o">=</span> <span class="s1">&#39;log/console.log&#39;</span>
<span class="n">WARNING_FILENAME</span> <span class="o">=</span> <span class="s1">&#39;log/warn.log&#39;</span>
<span class="n">ERROR_FILENAME</span> <span class="o">=</span> <span class="s1">&#39;log/error.log&#39;</span>


<span class="k">def</span> <span class="nf">log_init</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;log/&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s1">&#39;log/&#39;</span><span class="p">)</span>
    <span class="k">global</span> <span class="n">_console_logger</span><span class="p">,</span> <span class="n">_warn_logger</span><span class="p">,</span> <span class="n">_error_logger</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">RotatingFileHandler</span><span class="p">(</span>
        <span class="n">CONSOLE_FILENAME</span><span class="p">,</span> <span class="n">maxBytes</span><span class="o">=</span><span class="mi">20</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">,</span> <span class="n">backupCount</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">hdr</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
    <span class="n">_console_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span>
    <span class="n">_console_logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
    <span class="n">_console_logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">hdr</span><span class="p">)</span>
    <span class="n">_console_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

    <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">RotatingFileHandler</span><span class="p">(</span>
        <span class="n">WARNING_FILENAME</span><span class="p">,</span> <span class="n">maxBytes</span><span class="o">=</span><span class="mi">20</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">,</span> <span class="n">backupCount</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">hdr</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
    <span class="n">_warn_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;warn&#39;</span><span class="p">)</span>
    <span class="n">_warn_logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
    <span class="n">_warn_logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">hdr</span><span class="p">)</span>
    <span class="n">_warn_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARN</span><span class="p">)</span>

    <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">RotatingFileHandler</span><span class="p">(</span>
        <span class="n">ERROR_FILENAME</span><span class="p">,</span> <span class="n">maxBytes</span><span class="o">=</span><span class="mi">20</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">,</span> <span class="n">backupCount</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">hdr</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
    <span class="n">_error_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">)</span>
    <span class="n">_error_logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
    <span class="n">_error_logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">hdr</span><span class="p">)</span>
    <span class="n">_error_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">dlog</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="n">file_name</span><span class="p">,</span> <span class="n">file_no</span><span class="p">,</span> <span class="n">unused</span> <span class="o">=</span> <span class="n">find_caler</span><span class="p">()</span>
    <span class="n">time_str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="n">_console_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">,</span><span class="si">%d</span><span class="s1">] </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time_str</span><span class="p">,</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_no</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">ilog</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="n">file_name</span><span class="p">,</span> <span class="n">file_no</span><span class="p">,</span> <span class="n">unused</span> <span class="o">=</span> <span class="n">find_caler</span><span class="p">()</span>
    <span class="n">time_str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="n">_console_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">,</span><span class="si">%d</span><span class="s1">] </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time_str</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_no</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">wlog</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="n">file_name</span><span class="p">,</span> <span class="n">file_no</span><span class="p">,</span> <span class="n">unused</span> <span class="o">=</span> <span class="n">find_caler</span><span class="p">()</span>
    <span class="n">time_str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="n">_console_logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">,</span><span class="si">%d</span><span class="s1">] </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time_str</span><span class="p">,</span> <span class="s1">&#39;warning&#39;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_no</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
    <span class="n">_warn_logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">,</span><span class="si">%d</span><span class="s1">] </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time_str</span><span class="p">,</span> <span class="s1">&#39;warning&#39;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_no</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">elog</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="n">file_name</span><span class="p">,</span> <span class="n">file_no</span><span class="p">,</span> <span class="n">unused</span> <span class="o">=</span> <span class="n">find_caler</span><span class="p">()</span>
    <span class="n">time_str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="n">_console_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">,</span><span class="si">%d</span><span class="s1">] </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time_str</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_no</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
    <span class="n">_error_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">,</span><span class="si">%d</span><span class="s1">] </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time_str</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_no</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">find_caler</span><span class="p">():</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">co</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">f_code</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">co</span><span class="o">.</span><span class="n">co_filename</span><span class="p">),</span> <span class="n">f</span><span class="o">.</span><span class="n">f_lineno</span><span class="p">,</span> <span class="n">co</span><span class="o">.</span><span class="n">co_name</span><span class="p">)</span> <span class="k">if</span> <span class="n">co</span> <span class="o">!=</span> <span class="bp">None</span> <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">log_init</span><span class="p">()</span>
    <span class="n">dlog</span><span class="p">(</span><span class="s1">&#39;test.log </span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
    <span class="n">ilog</span><span class="p">(</span><span class="s1">&#39;test.log </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">123</span><span class="p">))</span>
    <span class="n">wlog</span><span class="p">(</span><span class="s1">&#39;test.log </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">123</span><span class="p">))</span>
    <span class="n">elog</span><span class="p">(</span><span class="s1">&#39;test.log </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">123</span><span class="p">))</span>

</code></pre></td></tr></table>
</div>
</div><p>单元测试代码如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="s2">&#34;&#34;&#34;
</span><span class="s2">Created on 10/10/17 11:27 AM
</span><span class="s2">@author: Chen Liang
</span><span class="s2">@function: 日志模块  单元测试
</span><span class="s2">&#34;&#34;&#34;</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="nb">reload</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">setdefaultencoding</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">mock</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">qk_log</span> <span class="kn">import</span> <span class="n">log_init</span><span class="p">,</span> <span class="n">dlog</span><span class="p">,</span> <span class="n">ilog</span><span class="p">,</span> <span class="n">wlog</span><span class="p">,</span> <span class="n">elog</span>


<span class="k">class</span> <span class="nc">TestQkLog</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">dt_str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;2017-10-11 11:08:59&#39;</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>

    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.os.path&#39;</span><span class="p">)</span>
    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.datetime.datetime&#39;</span><span class="p">)</span>
    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.logging&#39;</span><span class="p">)</span>
    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.find_caler&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_dlog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_caler</span><span class="p">,</span> <span class="n">mock_logging</span><span class="p">,</span> <span class="n">mock_datetime</span><span class="p">,</span> <span class="n">mock_path</span><span class="p">):</span>
        <span class="n">mock_path</span><span class="o">.</span><span class="n">exists</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">log_init</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">mock_logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="o">.</span><span class="n">called</span><span class="p">,</span> <span class="s2">&#34;Failed to not write log.&#34;</span><span class="p">)</span>

        <span class="n">mock_caler</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;qk_log_test&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">mock_datetime</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt_str</span>
        <span class="n">dlog</span><span class="p">(</span><span class="s1">&#39;any msg&#39;</span><span class="p">)</span>
        <span class="n">mock_logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="o">.</span><span class="n">assert_called_with</span><span class="p">(</span>
            <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">,</span><span class="si">%d</span><span class="s1">] </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;2017-10-11 11:08:59&#39;</span><span class="p">,</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="s1">&#39;qk_log_test&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;any msg&#39;</span><span class="p">))</span>

    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.os.path&#39;</span><span class="p">)</span>
    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.datetime.datetime&#39;</span><span class="p">)</span>
    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.logging&#39;</span><span class="p">)</span>
    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.find_caler&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_ilog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_caler</span><span class="p">,</span> <span class="n">mock_logging</span><span class="p">,</span> <span class="n">mock_datetime</span><span class="p">,</span> <span class="n">mock_path</span><span class="p">):</span>
        <span class="n">mock_path</span><span class="o">.</span><span class="n">exists</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">log_init</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">mock_logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">called</span><span class="p">,</span> <span class="s2">&#34;Failed to not write log.&#34;</span><span class="p">)</span>
        <span class="n">mock_caler</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;qk_log_test&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">mock_datetime</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt_str</span>
        <span class="n">ilog</span><span class="p">(</span><span class="s1">&#39;any msg&#39;</span><span class="p">)</span>
        <span class="n">mock_logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">assert_called_with</span><span class="p">(</span>
            <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">,</span><span class="si">%d</span><span class="s1">] </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;2017-10-11 11:08:59&#39;</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;qk_log_test&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;any msg&#39;</span><span class="p">))</span>

    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.os.path&#39;</span><span class="p">)</span>
    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.datetime.datetime&#39;</span><span class="p">)</span>
    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.logging&#39;</span><span class="p">)</span>
    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.find_caler&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_wlog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_caler</span><span class="p">,</span> <span class="n">mock_logging</span><span class="p">,</span> <span class="n">mock_datetime</span><span class="p">,</span> <span class="n">mock_path</span><span class="p">):</span>
        <span class="n">mock_path</span><span class="o">.</span><span class="n">exists</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">log_init</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">mock_logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;warn&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">called</span><span class="p">,</span> <span class="s2">&#34;Failed to not write log.&#34;</span><span class="p">)</span>
        <span class="n">mock_caler</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;qk_log_test&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">mock_datetime</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt_str</span>
        <span class="n">wlog</span><span class="p">(</span><span class="s1">&#39;any msg&#39;</span><span class="p">)</span>
        <span class="n">mock_logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;warn&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">warn</span><span class="o">.</span><span class="n">assert_called_with</span><span class="p">(</span>
            <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">,</span><span class="si">%d</span><span class="s1">] </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;2017-10-11 11:08:59&#39;</span><span class="p">,</span> <span class="s1">&#39;warning&#39;</span><span class="p">,</span> <span class="s1">&#39;qk_log_test&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;any msg&#39;</span><span class="p">))</span>

    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.os.path&#39;</span><span class="p">)</span>
    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.datetime.datetime&#39;</span><span class="p">)</span>
    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.logging&#39;</span><span class="p">)</span>
    <span class="nd">@mock.patch</span><span class="p">(</span><span class="s1">&#39;qk_log.find_caler&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_elog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_caler</span><span class="p">,</span> <span class="n">mock_logging</span><span class="p">,</span> <span class="n">mock_datetime</span><span class="p">,</span> <span class="n">mock_path</span><span class="p">):</span>
        <span class="n">mock_path</span><span class="o">.</span><span class="n">exists</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">log_init</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">mock_logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">called</span><span class="p">,</span> <span class="s2">&#34;Failed to not write log.&#34;</span><span class="p">)</span>
        <span class="n">mock_caler</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;qk_log_test&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">mock_datetime</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt_str</span>
        <span class="n">elog</span><span class="p">(</span><span class="s1">&#39;any msg&#39;</span><span class="p">)</span>
        <span class="n">mock_logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">assert_called_with</span><span class="p">(</span>
            <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">] [</span><span class="si">%s</span><span class="s1">,</span><span class="si">%d</span><span class="s1">] </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;2017-10-11 11:08:59&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;qk_log_test&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;any msg&#39;</span><span class="p">))</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>

</code></pre></td></tr></table>
</div>
</div><h1 id="对单元测试的看法">对单元测试的看法</h1>
<p>在一次整体改造Python数据统计分析项目时打算引进单元测试，在写完公共库的单元测试之后发现花费在单元测试上的时间较多，而且公共库不常改动，业务逻辑有比较混乱，因此团队决定放弃单元测试。对于以快速上线的初创公司和初创团队的项目来说，可以不用急着写单元测试，因为在一切改动都可能发生的情况下，再代码丢弃的时候对应的单元测试也就被丢弃了，浪费了过多的人力。</p>
<p>因此，初创团队不建议写单元测试，做好程序埋点和监控报警即可。</p>
    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">Suncle</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2017-11-14
        
    </span>
  </p>
  
  
</div>
<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">赞赏支持</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
        <img class="image" src="https://flowsnow.oss-cn-shanghai.aliyuncs.com/history/wechat-reward-image.png">
        <span>微信打赏</span>
      </label>
    <label class="qr-code-image" for="reward">
        <img class="image" src="https://flowsnow.oss-cn-shanghai.aliyuncs.com/history/alipay-reward-image.jpg">
        <span>支付宝打赏</span>
      </label>
  </div>
</div><footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">单元测试</a>
          <a href="/tags/%E6%B5%8B%E8%AF%95/">测试</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/2017/11/20/Erlang%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99Behaviour/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Erlang设计原则Behaviour</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/2017/11/13/AloneTripOfSoul-MagnificentHuangshan/">
            <span class="next-text nav-default">灵魂独旅之壮美黄山</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  
    <script src="https://utteranc.es/client.js"
            repo="suncle1993/suncle1993.github.io"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:im.suncle@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://www.facebook.com/sunclechen" class="iconfont icon-facebook" title="facebook"></a>
      <a href="https://github.com/suncle1993" class="iconfont icon-github" title="github"></a>
      <a href="https://weibo.com/3655576503" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://www.zhihu.com/people/flowsnow" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://space.bilibili.com/362765899" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="https://suncle.me/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> 本站总访问量 <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次 </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> 本站总访客数 <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 人 </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2015 - 
    2020
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Suncle</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.d7b7ada643c9c1a983026e177f141f7363b4640d619caf01d8831a6718cd44ea.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-72506112-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?41fc030db57d5570dd22f78997dc4a7e";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

<script id="baidu_push">
  (function(){
    if (window.location.hostname === 'localhost') return;
    var bp = document.createElement('script'); bp.async = true;
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>




</body>
</html>
