<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Suncle&#39;s Blog</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Suncle" /><meta name="description" content="关注Python、Goalng的web后端、DevOps等领域" /><meta name="keywords" content="计算机, 后端, Python, golang" />






<meta name="generator" content="Hugo 0.74.3 with theme even" />


<link rel="canonical" href="https://suncle.me/" />
  <link href="https://suncle.me/index.xml" rel="alternate" type="application/rss+xml" title="Suncle&#39;s Blog" />
  <link href="https://suncle.me/index.xml" rel="feed" type="application/rss+xml" title="Suncle&#39;s Blog" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<link href="/sass/main.min.651e6917abb0239242daa570c2bec9867267bbcd83646da5a850afe573347b44.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Suncle&#39;s Blog" />
<meta property="og:description" content="关注Python、Goalng的web后端、DevOps等领域" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://suncle.me/" />
<meta property="og:updated_time" content="2020-09-25T13:25:35+08:00" />
<meta itemprop="name" content="Suncle&#39;s Blog">
<meta itemprop="description" content="关注Python、Goalng的web后端、DevOps等领域">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Suncle&#39;s Blog"/>
<meta name="twitter:description" content="关注Python、Goalng的web后端、DevOps等领域"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Suncle&#39;s Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">首页</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">分类</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Suncle&#39;s Blog</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">首页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">分类</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <section id="posts" class="posts">
    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/2016/03/23/%E4%BA%8B%E5%8A%A1Transaction/">事务Transaction</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2016-03-23 </span>
      <div class="post-category">
          <a href="/categories/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93/"> Oracle数据库 </a>
          </div>
        <span class="more-meta"> 约 3298 字 </span>
        <span class="more-meta"> 预计阅读 7 分钟 </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <p>参考资料：</p>
<p><a href="https://docs.oracle.com/cd/E11882_01/server.112/e40540/transact.htmhttps://docs.oracle.com/cd/E11882_01/server.112/e40540/transact.htm" rel="nofollow">Transactions</a></p>
<p><a href="https://blog.csdn.net/junmail/article/details/5556561">关于Oracle事务的总结</a></p>
<hr>
<h2 id="什么是事务">什么是事务？</h2>
<p>事务(Transaction)是访问并可能更新数据库中各种<a href="http://baike.baidu.com/view/178581.htm">数据项</a>的一个程序执行单元(unit)。事务由事务开始(<strong>begin transaction</strong>)和事务结束(<strong>end transaction</strong>)之间执行的全体操作组成。</p>
<h2 id="事务的属性-acid">事务的属性-ACID</h2>
<ul>
<li>
<p><strong>原子性（Atomicity）</strong>-事务的原子性强调了一个事物是一个逻辑工作单元，是一个整体，是不可分割的。一个事务所包含的操作要么全部做，要不全部不做。</p>
</li>
<li>
<p><strong>一致性（Consistency）</strong>-一个事务执行一项数据库操作，事务使数据库从一种一致性的状态变换成另一种一致性状态。</p>
</li>
<li>
<p><strong>隔离性（Isolation）</strong>-在事务未提交前，它操作的数据，对其他用户不可见。</p>
</li>
<li>
<p><strong>持久性（Durability）</strong>-一旦事务成功完成，该事务对数据库所施加的所有更新都是永久的。</p>
<ul>
<li>redo日志&ndash;提交的事务被永久的记录到redo日志中。</li>
</ul>
</li>
</ul>
    </div>
    <div class="read-more">
      <a href="/2016/03/23/%E4%BA%8B%E5%8A%A1Transaction/" class="read-more-link">阅读更多</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/2016/03/22/PL-SQL-Developer%E8%BF%9E%E6%8E%A5%E6%9C%AC%E5%9C%B0Oracle-11g-64%E4%BD%8D%E6%95%B0%E6%8D%AE%E5%BA%93/">PL/SQL Developer连接本地Oracle 11g 64位数据库</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2016-03-22 </span>
      <div class="post-category">
          <a href="/categories/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93/"> Oracle数据库 </a>
          </div>
        <span class="more-meta"> 约 1794 字 </span>
        <span class="more-meta"> 预计阅读 4 分钟 </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <h2 id="登陆plsql">登陆PL/SQL</h2>
<p>假定本地电脑中已经安装了Oracle 11gR2数据库和PL/SQL developer。</p>
<p>如果没有安装可以在一下地址下载安装：</p>
<p>Oracle 11gR2数据库：<a href="https://www.oracle.com/technetwork/database/enterprise-edition/downloads/112010-win64soft-094461.html">https://www.oracle.com/technetwork/database/enterprise-edition/downloads/112010-win64soft-094461.html</a></p>
<p>PL/SQL developer(含注册机)：<a href="https://pan.baidu.com/s/1kUfY8GB">https://pan.baidu.com/s/1kUfY8GB</a> 密码: 1ky8</p>
<p>首先打开PL/SQL，会发现没有database可以选择，我们可以以非登录方式登陆PL/SQL（直接点cancel即可）。</p>
<p>开始设置：Tools-&gt;Preferences，进入后点击Oracle下面的connection，设置Oracle home和oci library。</p>
<p>由于我已经设置过了，如下图：</p>
<p><img src="https://flowsnow.oss-cn-shanghai.aliyuncs.com/history/Oracle-PLSQL%E6%9C%AC%E5%9C%B0%E9%85%8D%E7%BD%AE.png" alt=""></p>
<p>图中路径可能不一样，具体的看你的Oracle Home目录，如果不知道自己的Oracle Home目录的，可以去自己的环境变量中看一下。</p>
<p>点击Apply-&gt;OK，退出PL/SQL Developer，再次登录。</p>
    </div>
    <div class="read-more">
      <a href="/2016/03/22/PL-SQL-Developer%E8%BF%9E%E6%8E%A5%E6%9C%AC%E5%9C%B0Oracle-11g-64%E4%BD%8D%E6%95%B0%E6%8D%AE%E5%BA%93/" class="read-more-link">阅读更多</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/2016/03/21/%E9%97%AA%E5%9B%9Eflashback/">闪回flashback</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2016-03-21 </span>
      <div class="post-category">
          <a href="/categories/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93/"> Oracle数据库 </a>
          </div>
        <span class="more-meta"> 约 2803 字 </span>
        <span class="more-meta"> 预计阅读 6 分钟 </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <p><img src="https://flowsnow.oss-cn-shanghai.aliyuncs.com/history/Oracle-flashback_pic.png" alt=""></p>
<p><strong>参考资料：</strong><a href="https://docs.oracle.com/cd/E11882_01/appdev.112/e41502/adfns_flashback.htm">Using Oracle Flashback Technology</a></p>
<p>Oracle 11g的新特性闪回操作</p>
<ul>
<li>闪回查询
<ul>
<li>闪回查询</li>
<li>闪回版本查询</li>
<li>闪回事务查询</li>
</ul>
</li>
<li>闪回数据
<ul>
<li>闪回表</li>
<li>闪回删除</li>
<li>闪回数据</li>
<li>闪回归档</li>
</ul>
</li>
</ul>
<p>下面会分别介绍这些操作。在介绍这些操作之前先看下闪回特性是否开启。</p>
    </div>
    <div class="read-more">
      <a href="/2016/03/21/%E9%97%AA%E5%9B%9Eflashback/" class="read-more-link">阅读更多</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/2016/03/21/%E8%87%AA%E5%8A%A8%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86ASM/">自动存储管理ASM</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2016-03-21 </span>
      <div class="post-category">
          <a href="/categories/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93/"> Oracle数据库 </a>
          </div>
        <span class="more-meta"> 约 1567 字 </span>
        <span class="more-meta"> 预计阅读 4 分钟 </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <p>参考资料：</p>
<p><a href="https://docs.oracle.com/cd/B19306_01/server.102/b14231/storeman.htm#ADMIN036">https://docs.oracle.com/cd/B19306_01/server.102/b14231/storeman.htm#ADMIN036</a></p>
<h2 id="什么是asm">什么是ASM？</h2>
<p>ASM是Automatic Storage Management（自动存储管理）的缩写。ASM是一个集成的高性能的文件系统和卷管理器。Oracle将所有的存储分为disk groups，我们只需要管理这些disk groups，而不用去管具体的数据文件。</p>
<p>In the SQL statements that you use for creating database structures such as tablespaces, control files, and redo and archive log files, you specify file location in terms of disk groups. ASM then creates and manages the associated underlying files（底层文件） for you.</p>
<h2 id="为什么使用asm">为什么使用ASM？</h2>
<ul>
<li>提供高效率的存储管理</li>
<li>提供完整的集群文件系统和卷管理能力</li>
</ul>
<p><strong>ASM的优点：</strong></p>
<p><strong>Mirroring and Striping</strong>（镜像化和条带化）</p>
<p>条带化是一种用于在多个磁盘驱动器之间分散数据的技术。一个大的数据段被分为较小的单元，这些单元分布在可用设备之间。分隔数据的单元称为“数据单元大小”或“条带大小”，是指向每个磁盘写入这些条带的大小。可以同时读写的并行条带数量称为“条带宽度”。分条可以加快从磁盘存储中获取数据的操作，这是因为它扩展了总I/O带宽的能力。这样就优化了性能和磁盘利用率，从而不再需要手动I/O 性能调优。</p>
<p>ASM镜像化选项:</p>
<table>
<thead>
<tr>
<th>Mirroring Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>2-way mirroring</td>
<td>Each extent has 1 mirrored copy.</td>
</tr>
<tr>
<td>3-way mirroring</td>
<td>Each extent has 2 mirrored copies.</td>
</tr>
<tr>
<td>Unprotected</td>
<td>ASM provides no mirroring. Used when mirroring is provided by the disk subsystem itself.</td>
</tr>
</tbody>
</table>
    </div>
    <div class="read-more">
      <a href="/2016/03/21/%E8%87%AA%E5%8A%A8%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86ASM/" class="read-more-link">阅读更多</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/2016/03/18/Rman%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E5%92%8C%E7%AE%A1%E7%90%86/">Rman备份恢复和管理</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2016-03-18 </span>
      <div class="post-category">
          <a href="/categories/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93/"> Oracle数据库 </a>
          </div>
        <span class="more-meta"> 约 1207 字 </span>
        <span class="more-meta"> 预计阅读 3 分钟 </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <p><img src="https://flowsnow.oss-cn-shanghai.aliyuncs.com/history/Oracle-Rman%E7%BB%84%E4%BB%B6.jpg" alt=""></p>
<p>参考资料：</p>
<ul>
<li>
<p><a href="https://www.cnblogs.com/Ronger/archive/2011/12/29/2306367.html">Oracle之Rman入门指南</a></p>
</li>
<li>
<p><a href="http://www.5ienet.com/note/html/rman/index.shtml">一步一步学Rman</a></p>
</li>
</ul>
<h2 id="rman简介">Rman简介</h2>
<p>Rman-Recover manager恢复管理工具。</p>
<p>Oracle集成了很多环境的一个数据库备份和恢复的工具。</p>
<p>Rman可以做下列事情：</p>
<ul>
<li>数据库热备份
<ul>
<li>全库备份和恢复
<ul>
<li>数据库克隆（DG）</li>
</ul>
</li>
<li>增量备份和恢复</li>
<li>表空间备份和恢复</li>
<li>数据文件备份和恢复</li>
<li>归档备份和恢复</li>
<li>控制文件和参数文件备份和恢复</li>
</ul>
</li>
<li>数据库冷备份</li>
<li>备份集的管理
<ul>
<li>备份策略</li>
<li>保留和删除备份数据</li>
<li>&hellip;&hellip;</li>
</ul>
</li>
</ul>
    </div>
    <div class="read-more">
      <a href="/2016/03/18/Rman%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E5%92%8C%E7%AE%A1%E7%90%86/" class="read-more-link">阅读更多</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/2016/03/16/Hexo%E5%8D%9A%E5%AE%A2%E6%8D%A2%E7%94%B5%E8%84%91%E6%AD%A5%E9%AA%A4/">Hexo博客换电脑步骤</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2016-03-16 </span>
      <div class="post-category">
          <a href="/categories/Hexo%E5%8D%9A%E5%AE%A2/"> Hexo博客 </a>
          </div>
        <span class="more-meta"> 约 502 字 </span>
        <span class="more-meta"> 预计阅读 2 分钟 </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <p><img src="http://upload.chinaz.com/2015/1016/1444964380585.png" alt=""></p>
<p>hexo博客固然好，但是在多个电脑上怎么同步写博客呢？</p>
    </div>
    <div class="read-more">
      <a href="/2016/03/16/Hexo%E5%8D%9A%E5%AE%A2%E6%8D%A2%E7%94%B5%E8%84%91%E6%AD%A5%E9%AA%A4/" class="read-more-link">阅读更多</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/2016/03/16/%E4%BD%BF%E7%94%A8github%E7%AE%A1%E7%90%86hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E6%BA%90%E6%96%87%E4%BB%B6/">使用Github管理Hexo博客的源文件</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2016-03-16 </span>
      <div class="post-category">
          <a href="/categories/Hexo%E5%8D%9A%E5%AE%A2/"> Hexo博客 </a>
          </div>
        <span class="more-meta"> 约 1085 字 </span>
        <span class="more-meta"> 预计阅读 3 分钟 </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <p>使用Github管理Hexo博客的源文件</p>
<h2 id="1创建github仓库">1.创建github仓库</h2>
<p>Create a New Repository，用<a href="https://github.com/repositories/new">https://github.com/repositories/new</a>来创建新仓库，填好名称后Create，之后会出现一些仓库的配置信息。这时候就表示配置好了。不需要用README来初始化仓库。我创建的仓库名称是BlogSourceFile。</p>
<p><img src="https://flowsnow.oss-cn-shanghai.aliyuncs.com/history/github%E5%88%9B%E5%BB%BA%E4%BB%93%E5%BA%93.png" alt=""></p>
    </div>
    <div class="read-more">
      <a href="/2016/03/16/%E4%BD%BF%E7%94%A8github%E7%AE%A1%E7%90%86hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E6%BA%90%E6%96%87%E4%BB%B6/" class="read-more-link">阅读更多</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/2016/03/16/Oracle%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">Oracle数据结构</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2016-03-16 </span>
      <div class="post-category">
          <a href="/categories/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93/"> Oracle数据库 </a>
          </div>
        <span class="more-meta"> 约 3514 字 </span>
        <span class="more-meta"> 预计阅读 8 分钟 </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <h2 id="oracle的数据存储结构">Oracle的数据存储结构</h2>
<p><img src="https://flowsnow.oss-cn-shanghai.aliyuncs.com/history/Oracle-Oracle%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84.png" alt=""></p>
<ul>
<li>表空间（tablespace）&ndash;Oracle中最大的逻辑存储单位</li>
<li>数据文件（data file）&ndash;表空间物理存储载体</li>
<li>段（segment）&ndash;Oracle中所有占用空间的对象的总称</li>
<li>extend&ndash;段的组成单位</li>
<li>数据块（data block）&ndash;extend的组成单位，是Oracle存储和数据操作的最小单位。</li>
</ul>
<h2 id="数据块">数据块</h2>
<p>数据块是Oracle存储和数据操作的最小单位，但不一定和操作系统的os块相同，一个数据块可能有多个os块构成。</p>
<p><img src="https://flowsnow.oss-cn-shanghai.aliyuncs.com/history/Oracle-%E6%95%B0%E6%8D%AE%E5%9D%97%E5%92%8Cos%E5%9D%97.png" alt=""></p>
    </div>
    <div class="read-more">
      <a href="/2016/03/16/Oracle%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="read-more-link">阅读更多</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/2016/03/16/%E5%9B%9E%E6%BB%9A%E6%AE%B5undo/">回滚段undo</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2016-03-16 </span>
      <div class="post-category">
          <a href="/categories/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93/"> Oracle数据库 </a>
          </div>
        <span class="more-meta"> 约 2264 字 </span>
        <span class="more-meta"> 预计阅读 5 分钟 </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <hr>
<h2 id="undo的作用">Undo的作用</h2>
<ul>
<li>数据的回滚</li>
<li>一致性读</li>
<li>表的闪回（事务，查询的闪回..）</li>
<li>失败会话的恢复</li>
</ul>
<h2 id="回滚rollback操作">回滚rollback操作</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">SQL&gt; archive log list;
ORA-01031: 权限不足
SQL&gt; conn /as sysdba
已连接。
SQL&gt; archive log list;
数据库日志模式            存档模式
自动存档             启用
存档终点            USE_DB_RECOVERY_FILE_DEST
最早的联机日志序列     45
下一个存档日志序列   47
当前日志序列           47
SQL&gt; create table t1(id int);

表已创建。

SQL&gt; select * from t1;

未选定行

SQL&gt; insert into t1 values(&#39;1&#39;);

已创建 1 行。

SQL&gt; insert into t1 values(&#39;2&#39;);

已创建 1 行。

SQL&gt; rollback;

回退已完成。

SQL&gt; select * from t1;

未选定行

SQL&gt; desc t1;
 名称                                      是否为空? 类型
 ----------------------------------------- -------- ----------------------------

 ID                                                 NUMBER(38)

SQL&gt; select * from t1;

未选定行

SQL&gt; insert into t1 values(1);

已创建 1 行。

SQL&gt; insert into t1 values(2);

已创建 1 行。

SQL&gt; select * from t1;

        ID
----------
         1
         2

SQL&gt; rollback;

回退已完成。

SQL&gt; select * from t1;

未选定行

SQL&gt; archive log list;
数据库日志模式            存档模式
自动存档             启用
存档终点            USE_DB_RECOVERY_FILE_DEST
最早的联机日志序列     45
下一个存档日志序列   47
当前日志序列           47
SQL&gt; shutdown immediate;
数据库已经关闭。
已经卸载数据库。
ORACLE 例程已经关闭。
SQL&gt; startup mount;
ORACLE 例程已经启动。

Total System Global Area 3307048960 bytes
Fixed Size                  2180264 bytes
Variable Size            1828719448 bytes
Database Buffers         1459617792 bytes
Redo Buffers               16531456 bytes
数据库装载完毕。
SQL&gt; alter database noarchivelog;
alter database noarchivelog
*
第 1 行出现错误:
ORA-38774: 无法禁用介质恢复 - 闪回数据库已启用


SQL&gt; alter database flashback off;

数据库已更改。

SQL&gt;
SQL&gt; alter database noarchivelog;

数据库已更改。

SQL&gt; alter database open;

数据库已更改。

SQL&gt; archive log list;
数据库日志模式             非存档模式
自动存档             禁用
存档终点            USE_DB_RECOVERY_FILE_DEST
最早的联机日志序列     45
当前日志序列           47
SQL&gt; select * from t1;

未选定行

SQL&gt; insert into t1 values(1);

已创建 1 行。

SQL&gt; insert into t1 values(2);

已创建 1 行。

SQL&gt; select * from t1;

        ID
----------
         1
         2

SQL&gt; rollback;

回退已完成。

SQL&gt; select * from t1;

未选定行

SQL&gt; insert into t1 values(1);

已创建 1 行。

SQL&gt; insert into t1 values(2);

已创建 1 行。

SQL&gt; commit;

提交完成。

SQL&gt; rollback;

回退已完成。

SQL&gt; select * from t1;

        ID
----------
         1
         2
</code></pre></td></tr></table>
</div>
</div><p>可见rollback操作和当前数据库 归档模式并没有关系，只和commit操作有关，一旦commit就无法回滚。</p>
<p>如果没有指定 rollback 到哪一个保存点savepoint上，就意味着全部Rollback，而不是只是rollback一条操作。</p>
    </div>
    <div class="read-more">
      <a href="/2016/03/16/%E5%9B%9E%E6%BB%9A%E6%AE%B5undo/" class="read-more-link">阅读更多</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/2016/03/16/%E9%87%8D%E5%81%9A%E6%97%A5%E5%BF%97%E5%92%8C%E6%97%A5%E5%BF%97%E6%8C%96%E6%8E%98/">重做日志和日志挖掘</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2016-03-16 </span>
      <div class="post-category">
          <a href="/categories/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93/"> Oracle数据库 </a>
          </div>
        <span class="more-meta"> 约 2404 字 </span>
        <span class="more-meta"> 预计阅读 5 分钟 </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <h2 id="重做日志-redo-log">重做日志-Redo log</h2>
<p><strong>首先给出参考资料：</strong></p>
<p><a href="https://docs.oracle.com/database/121/ADMIN/onlineredo.htm#ADMIN007">1、Oracle官网-Managing the Redo Log</a></p>
<h3 id="为什么需要redo-log">为什么需要redo log</h3>
<ul>
<li>内存中数据修改后，不必立即更新到磁盘&mdash;效率</li>
<li>由日志完成数据的保护目的&mdash;效率</li>
<li>其他副产品
<ul>
<li>数据恢复（备份集+归档日志）</li>
<li>数据同步（DG，streams，goldengate）</li>
<li>日志挖掘</li>
</ul>
</li>
</ul>
<h3 id="什么是redo-log">什么是Redo log</h3>
<p>重做日志包含所有数据产生的历史改变记录。</p>
<p>重做日志文件通常用于</p>
<ul>
<li>恢复</li>
<li>日志挖掘</li>
<li>流</li>
<li>数据库产生的每个改动
<ul>
<li>写入数据块缓冲之前，先写入redo log buffer &ndash;内存</li>
<li>写入数据文件之前先写入日志文件 &ndash;数据文件</li>
</ul>
</li>
<li>当提交后，redo log buffer被刷入redo log files</li>
</ul>
<h3 id="关于vlog视图">关于v$log视图</h3>
<p>v$log从控制文件中显示日志文件的信息。可参考官网资料<a href="https://docs.oracle.com/database/121/REFRN/GUID-FCD3B70B-7B98-40D8-98AB-9F6A85E69F57.htm#REFRN30127">v$log</a></p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Datatype</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>GROUP#</td>
<td>NUMBER</td>
<td>Log group number</td>
</tr>
<tr>
<td>THREAD#</td>
<td>NUMBER</td>
<td>Log thread number</td>
</tr>
<tr>
<td>SEQUENCE#</td>
<td>NUMBER</td>
<td>Log sequence number</td>
</tr>
<tr>
<td>BYTES</td>
<td>NUMBER</td>
<td>Size of the log (in bytes)</td>
</tr>
<tr>
<td>BLOCKSIZE</td>
<td>NUMBER</td>
<td>Block size of the logfile (512 or 4096)</td>
</tr>
<tr>
<td>MEMBERS</td>
<td>NUMBER</td>
<td>Number of members in the log group</td>
</tr>
<tr>
<td>ARCHIVED</td>
<td>VARCHAR2(3)</td>
<td>Archive status (<code>YES</code>) or (<code>NO</code>)</td>
</tr>
<tr>
<td>STATUS</td>
<td>VARCHAR2(16)</td>
<td>UNUSED,CURRENT,ACTIVE,CLEARING,CLEARING_CURRENT,INACTIVE</td>
</tr>
<tr>
<td>FIRST_CHANGE#</td>
<td>NUMBER</td>
<td>Lowest system change number (SCN) in the log</td>
</tr>
<tr>
<td>FIRST_TIME</td>
<td>DATE</td>
<td>Time of the first SCN in the log</td>
</tr>
<tr>
<td>NEXT_CHANGE#</td>
<td>NUMBER</td>
<td>Highest change number (SCN) in the log. When <code>STATUS=CURRENT</code>, <code>NEXT_CHANGE#</code>is set to the highest possible SCN, 281474976710655.</td>
</tr>
<tr>
<td>NEXT_TIME</td>
<td>DATE</td>
<td>Time of the highest SCN in the log. When <code>STATUS=CURRENT</code>, <code>NEXT_TIME</code> is set to<code>NULL</code>.</td>
</tr>
<tr>
<td>CON_ID</td>
<td>NUMBER</td>
<td>0，1，n三种情况</td>
</tr>
</tbody>
</table>
<p>日志文件的六种状态UNUSED,CURRENT,ACTIVE,CLEARING,CLEARING_CURRENT,INACTIVE代表的意思分别如下所述：</p>
<ul>
<li><strong>UNUSED</strong> - Online redo log has never been written to. This is the state of a redo log that was just added, or just after a <em>RESETLOGS</em>, when it is not the current redo log.</li>
<li><strong>CURRENT</strong> - Current redo log. This implies that the redo log is active. The redo log could be open or closed.</li>
<li><strong>ACTIVE</strong> - Log is active but is not the current log. It is needed for crash recovery. It may be in use for block recovery. It may or may not be archived.</li>
<li><strong>CLEARING</strong> - Log is being re-created as an empty log after an <code>ALTER DATABASE CLEAR LOGFILE</code> statement. After the log is cleared, the status changes to <code>UNUSED</code>.</li>
<li><strong>CLEARING_CURRENT</strong> - Current log is being cleared of a closed thread. The log can stay in this status if there is some failure in the switch such as an I/O error writing the new log header.</li>
<li><strong>INACTIVE</strong> - Log is no longer needed for instance recovery. It may be in use for media recovery. It may or may not be archived.</li>
</ul>
<h3 id="lgwr如何重复使用redo-log-files">LGWR如何重复使用redo log files</h3>
<p><img src="https://flowsnow.oss-cn-shanghai.aliyuncs.com/history/Oracle-Reuse%20of%20Redo%20Log%20Files%20by%20LGWR.gif" alt="Figure 11-1 Reuse of Redo Log Files by LGWR"></p>
<p>上图就是Oracle LGWR进程向redo log files中写入redo记录的过程，可见，Oracle数据库每次只是用一个redo log file来存储redo log buffer中的redo记录。LGWR正在写入的那个redo log file就是current redo log file。</p>
<p>可用于实例恢复的redo log files就是active redo log files。</p>
<p>不再用于实例恢复的redo log files就是inactive redo log files。</p>
<p>如果数据库当前是Archivelog模式，那么直到有一个后台归档进程ARCn已经归档成功，数据库才能重用或者覆盖active online log file。</p>
<p>如果数据库当前是NoArchivelog模式，当最后一个redo log file写满的时候，LGWR会继续按顺序覆盖下一个inactive redo log file。</p>
    </div>
    <div class="read-more">
      <a href="/2016/03/16/%E9%87%8D%E5%81%9A%E6%97%A5%E5%BF%97%E5%92%8C%E6%97%A5%E5%BF%97%E6%8C%96%E6%8E%98/" class="read-more-link">阅读更多</a>
    </div>
  </div>
</article>

    </section>
  
  <nav class="pagination">
    <a class="prev" href="/page/11/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text">上一页</span>
      </a>
    <a class="next" href="/page/13/">
        <span class="next-text">下一页</span>
        <i class="iconfont icon-right"></i>
      </a>
  </nav>
        </div>
        

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:im.suncle@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://www.facebook.com/sunclechen" class="iconfont icon-facebook" title="facebook"></a>
      <a href="https://github.com/suncle1993" class="iconfont icon-github" title="github"></a>
      <a href="https://weibo.com/3655576503" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://www.zhihu.com/people/flowsnow" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://space.bilibili.com/362765899" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="https://suncle.me/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> 本站总访问量 <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次 </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> 本站总访客数 <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 人 </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2015 - 
    2020
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Suncle</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.d7b7ada643c9c1a983026e177f141f7363b4640d619caf01d8831a6718cd44ea.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-72506112-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?41fc030db57d5570dd22f78997dc4a7e";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

<script id="baidu_push">
  (function(){
    if (window.location.hostname === 'localhost') return;
    var bp = document.createElement('script'); bp.async = true;
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>




</body>
</html>
